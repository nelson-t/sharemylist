<!DOCTYPE html>
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</head>
<body>
<div id="div1"><h2>SIMPLE SPOTIFY CONTROL</h2></div>
	<div class="auto" id="auto" style="display: none">
	JSON COMPLETO:
	<p>
	<textarea name="" id="myTextarea" cols="100" rows="5"></textarea>
	<p>
	</div>
<div>	
	Track:<p>
	<textarea name="" id="myTextarea2" cols="100" rows="2"></textarea>
</div>
<img id="img1" alt="Spotify Image" height="300" width="300">
<p>
<button id="b-prev"><-PREV</button>
<button id="b1">Get External SPOTIFY Content</button>
<button id="b-next">NEXT-></button>
<button id="b-pause">PAUSE</button>
<button id="b-pause">PLAY</button>
</body>

<script>


$(document).ready(function(){
   var hash = window.location.hash.split("&")[0].split("=")[1];

   $.fn.displayTrackInfo = function(){ 
     $.ajax({
        url: 'https://api.spotify.com/v1/me/player/currently-playing',
        method: 'GET',
        headers: {
          'Content-Type' : 'application/json', 
          'Accept' : 'application/json', 
          'Authorization' : 'Bearer '+hash
        },
        success: function(data){
           var textedJson = JSON.stringify(data, undefined, 4);
           $('#myTextarea').text(textedJson);
           $('#myTextarea2').text(data.item.name+ " from "+data.item.artists[0].name);
           $('#img1').attr("src", data.item.album.images[0].url);
        }
     });
   }

   $("#b1").click(function(){
      $.fn.displayTrackInfo();
   });

  $("#b-next").click(function(){
    $.ajax({
        url: 'https://api.spotify.com/v1/me/player/next',
        method: 'POST',
        headers: {
          'Content-Type' : 'application/json', 
          'Accept' : 'application/json', 
          'Authorization' : 'Bearer '+hash
        },
       success: function(result){
          setTimeout(function() {
             $.fn.displayTrackInfo();}, 1000);
       }
    });

  });

  $("#b-prev").click(function(){
    $.ajax({
        url: 'https://api.spotify.com/v1/me/player/previous',
        method: 'POST',
        headers: {
          'Content-Type' : 'application/json', 
          'Accept' : 'application/json', 
          'Authorization' : 'Bearer '+hash
        },
       success: function(result){
         setTimeout(function() {
             $.fn.displayTrackInfo();}, 500);
       }
    });

  });
  
  $("#b-pause").click(function(){
    $.ajax({
        url: 'https://api.spotify.com/v1/me/player/pause',
        method: 'PUT',
        headers: {
          'Content-Type' : 'application/json', 
          'Accept' : 'application/json', 
          'Authorization' : 'Bearer '+hash
        },
       success: function(result){
         $.fn.displayTrackInfo();
       }
    });

  });
    $("#b-play").click(function(){
    $.ajax({
        url: 'https://api.spotify.com/v1/me/player/play',
        method: 'PUT',
        headers: {
          'Content-Type' : 'application/json', 
          'Accept' : 'application/json', 
          'Authorization' : 'Bearer '+hash
        },
       success: function(result){
         $.fn.displayTrackInfo();
       }
    });

  });
  
  $("#b1").click();
  
});
</script>

</html>
